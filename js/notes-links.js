// notes-links.js — 구절 링크 약어 변환 및 생성
function shortRef(ref){
  const m = ref.match(/^(.+?)\s(\d+:\d+)$/);
  if(!m) return ref;
  const book = m[1], cv = m[2];
  const abbr = {
    '창세기':'창','출애굽기':'출','레위기':'레','민수기':'민','신명기':'신',
    '여호수아기':'수','사사기':'삿','룻기':'룻','사무엘기상':'삼상','사무엘기하':'삼하',
    '열왕기상':'왕상','열왕기하':'왕하','역대기상':'대상','역대기하':'대하',
    '에스라':'스','느헤미야기':'느','에스더기':'에','욥기':'욥','시편':'시',
    '잠언':'잠','전도서':'전','솔로몬의아가':'아','이사야서':'사','예레미야서':'렘',
    '예레미야애가':'애','에스겔서':'겔','다니엘서':'단','호세아서':'호','요엘서':'욜',
    '아모스서':'암','오바댜서':'옵','요나서':'욘','미가서':'미','나훔서':'나',
    '하박국서':'합','스바냐서':'습','학개서':'학','스가랴서':'슥','말라기서':'말',
    '마태복음':'마','마가복음':'막','누가복음':'눅','요한복음':'요','사도행전':'행',
    '로마서':'롬','고린도전서':'고전','고린도후서':'고후','갈라디아서':'갈',
    '에베소서':'엡','빌립보서':'빌','골로새서':'골','데살로니가전서':'살전',
    '데살로니가후서':'살후','디모데전서':'딤전','디모데후서':'딤후','디도서':'딛',
    '빌레몬서':'몬','히브리서':'히','야고보서':'약','베드로전서':'벧전',
    '베드로후서':'벧후','요한일서':'요일','요한이서':'요이','요한삼서':'요삼',
    '유다서':'유','요한계시록':'계'
  };
  const short = abbr[book] || book[0];
  return short + ' ' + cv;
}

function makVLink(key, ref){
  const display = shortRef(ref);
  return `<span class="vlink" data-ref="${key}" data-ref-label="${ref}" contenteditable="false" onclick="navByKey('${key}')" title="${ref}"><i class="fa fa-book-open"></i> ${display}</span>&#8203;`;
}

function navByKey(key){
  const p=key.split('_');
  if(p.length<2)return;
  openBibleTab(p[0], parseInt(p[1]), p[2]?parseInt(p[2]):null);
}
