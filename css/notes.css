/* ═══════════════════════════════════════════════
   RIGHT PANEL — wider, no inner explorer
═══════════════════════════════════════════════ */
#rightPanel {
  width:640px; flex-shrink:0;
  background:var(--bg2); border-left:1px solid var(--border);
  display:flex; flex-direction:column; overflow:hidden; transition:width .22s;
  position:relative;
}
#rightPanel.rp-hide { width:0; border:none; overflow:hidden }

.rp-tabs {
  display:flex; border-bottom:1px solid var(--border);
  background:var(--bg2); flex-shrink:0; height:38px;
}
.rp-subtabs {
  display:flex; width:100%; height:100%;
}
.rp-tab {
  flex:1; height:100%; display:flex; align-items:center; justify-content:center;
  gap:4px; font-size:11px; color:var(--text3); cursor:pointer;
  border-bottom:2px solid transparent; transition:all .15s; white-space:nowrap;
  padding:0 4px;
}
.rp-tab:hover:not(.act) { color:var(--text2) }
.rp-tab.act { color:#34d399; border-bottom-color:#34d399; font-weight:700 }
.rp-body { flex:1; overflow:hidden; display:flex; flex-direction:column }
.rp-sec { display:none; flex:1; flex-direction:column; overflow:hidden }
.rp-sec.act { display:flex }

/* Note list items */
.notelist-item {
  display:flex; align-items:center; gap:8px; padding:7px 8px; border-radius:5px;
  margin:1px 4px; cursor:pointer; font-size:12px; color:var(--text2);
  transition:background .1s;
}
.notelist-item:hover { background:var(--bg3) }
.notelist-item.nli-active { background:var(--gold-dim); color:var(--gold) }

/* ── Outline ── */
.outline-wrap { display:flex; flex-direction:column; flex:1; overflow:hidden }
.outline-toolbar {
  display:flex; align-items:center; justify-content:space-between;
  padding:8px 12px; border-bottom:1px solid var(--border); flex-shrink:0;
}
.outline-tb-btn {
  width:24px; height:24px; border-radius:4px; font-size:11px;
  display:flex; align-items:center; justify-content:center;
  color:var(--text3); background:var(--bg3); border:1px solid var(--border);
  cursor:pointer; transition:all .12s;
}
.outline-tb-btn:hover { color:var(--gold); border-color:var(--gold) }
.ol-para { margin:0 }
.ol-para-head, .ol-folder-head {
  display:flex; align-items:center; gap:6px; padding:7px 12px;
  cursor:pointer; font-size:12px; transition:background .1s;
  border-bottom:1px solid var(--border);
}
.ol-para-head:hover, .ol-folder-head:hover { background:var(--bg3) }
.ol-arrow { font-size:8px; color:var(--text3); transition:transform .15s; flex-shrink:0; width:10px }
.ol-arrow.open { transform:rotate(90deg) }
.ol-range { font-family:'JetBrains Mono',monospace; font-size:10px; color:var(--gold); font-weight:700; flex-shrink:0; min-width:50px }
.ol-preview { color:var(--text2); flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; font-size:11px }
.ol-badge { font-size:9px; background:var(--gold-dim); color:var(--gold); border-radius:8px; padding:1px 6px; flex-shrink:0 }
.ol-para-body { display:none; padding-left:0 }
.ol-para-body.open { display:block }

/* Note items in outline */
.ol-note {
  padding:6px 12px 6px 28px; cursor:pointer; transition:background .1s;
  border-bottom:1px solid var(--border); border-left:2px solid transparent;
}
.ol-note:hover { background:var(--bg3) }
.ol-note.ol-sel { background:var(--gold-dim); border-left-color:var(--gold) }
.ol-note-head {
  display:flex; align-items:center; gap:6px; font-size:12px;
}
.ol-note-title { flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; color:var(--text); font-weight:600 }
.ol-note-meta { display:flex; flex-wrap:wrap; gap:4px; margin-top:4px; padding-left:16px }
.ol-tag { font-size:9px; color:var(--text3); background:var(--bg4); border-radius:3px; padding:1px 5px }

/* Headings sub-outline */
.ol-headings { margin:4px 0 2px }
.ol-heading-item {
  display:flex; align-items:center; gap:5px; padding:3px 12px;
  font-size:11px; cursor:pointer; transition:background .1s; border-radius:3px;
}
.ol-heading-item:hover { background:var(--bg4); color:var(--gold) }

.ol-verse {
  display:flex; align-items:center; gap:6px; padding:4px 12px 4px 16px;
  cursor:pointer; font-size:11px; transition:background .1s;
  border-left:2px solid transparent;
}
.ol-verse:hover { background:var(--bg3); border-left-color:var(--border2) }
.ol-verse.ol-sel { background:var(--gold-dim); border-left-color:var(--gold) }
.ol-vnum { font-family:'JetBrains Mono',monospace; font-size:10px; color:var(--gold); opacity:.6; min-width:20px; text-align:right; flex-shrink:0 }
.ol-vtxt { color:var(--text2); flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.ol-icons { display:flex; gap:3px; flex-shrink:0 }
.ol-icon { font-size:9px }

/* ═══════════════════════════════════════════════
   NOTE LAYOUT — full width editor, drawer explorer
═══════════════════════════════════════════════ */
#notesLayout { display:flex; flex:1; overflow:hidden; position:relative; flex-direction:column }

/* ── FLOATING FOLDER DRAWER (slides from right) ── */
#noteExplorer {
  position:absolute; top:0; right:0; bottom:0;
  width:260px; z-index:50;
  background:var(--bg2); border-left:1px solid var(--border2);
  display:flex; flex-direction:column; overflow:hidden;
  transform:translateX(100%);
  transition:transform .25s cubic-bezier(.4,0,.2,1), box-shadow .25s;
  box-shadow:none;
}
#noteExplorer.exp-open {
  transform:translateX(0);
  box-shadow:-6px 0 24px rgba(0,0,0,.45);
}

/* Drawer overlay (dim background when open) */
#explorerOverlay {
  position:absolute; inset:0; z-index:49;
  background:rgba(0,0,0,.35);
  display:none; cursor:pointer;
}
#explorerOverlay.show { display:block }

.exp-head {
  padding:0 10px; height:36px; display:flex; align-items:center; justify-content:space-between;
  border-bottom:1px solid var(--border); flex-shrink:0; background:var(--bg3);
}
.exp-title { font-size:10px; font-weight:700; color:var(--text3); text-transform:uppercase; letter-spacing:1px }
.exp-actions { display:flex; gap:3px }
.exp-btn {
  width:24px; height:24px; border-radius:3px; font-size:10px;
  display:flex; align-items:center; justify-content:center;
  color:var(--text3); transition:all .12s;
}
.exp-btn:hover { background:var(--bg4); color:var(--text) }

/* Folder tree */
#folderTree { flex:1; overflow-y:auto; padding:4px 0 }
.ftree-folder { }
.ftree-fhead {
  display:flex; align-items:center; gap:5px; padding:4px 8px;
  cursor:pointer; border-radius:4px; margin:1px 4px;
  transition:background .1s; font-size:12px; color:var(--text2);
  user-select:none;
}
.ftree-fhead:hover { background:var(--bg4) }
.ftree-fhead.fsel { background:var(--gold-sel); color:var(--gold2) }
.ftree-arrow { font-size:9px; width:12px; color:var(--text3); transition:transform .15s; flex-shrink:0 }
.ftree-arrow.open { transform:rotate(90deg) }
.ftree-ficon { font-size:11px; flex-shrink:0; color:var(--text3) }
.ftree-fname { flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.ftree-count { font-size:10px; color:var(--text3); flex-shrink:0 }
.ftree-notes { padding-left:20px; display:none }
.ftree-notes.open { display:block }
.ftree-note {
  display:flex; align-items:center; gap:5px; padding:3px 8px; border-radius:4px;
  margin:1px 4px; cursor:pointer; font-size:11px; color:var(--text3);
  transition:background .1s; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.ftree-note:hover { background:var(--bg4); color:var(--text2) }
.ftree-note.nsel { background:var(--gold-dim); color:var(--gold) }
.ftree-note i { font-size:9px; flex-shrink:0 }

/* Note editor area — full width */
#noteEditor {
  flex:1; display:flex; flex-direction:column; overflow:hidden; min-width:0;
}

/* Editor topbar */
.ned-head {
  height:36px; border-bottom:1px solid var(--border); flex-shrink:0;
  display:flex; align-items:center; padding:0 10px; gap:6px; background:var(--bg2);
}
/* Back button */
.back-btn {
  display:flex; align-items:center; gap:4px; font-size:11px;
  color:var(--text3); padding:3px 8px; border-radius:4px;
  border:1px solid var(--border); background:var(--bg3);
  transition:all .14s; flex-shrink:0; cursor:pointer;
}
.back-btn:hover { color:var(--gold); border-color:var(--gold); background:var(--gold-dim) }
.back-btn i { font-size:10px }

/* ── Note Navigation Bar ── */
.note-nav-bar {
  display:flex; align-items:center; gap:6px;
  padding:5px 10px; border-top:1px solid var(--border);
  background:var(--bg2); flex-shrink:0; min-height:32px;
  overflow:hidden;
}
.nav-back-btn {
  display:flex; align-items:center; justify-content:center;
  width:24px; height:24px; border-radius:4px;
  color:var(--text3); background:var(--bg3); border:1px solid var(--border);
  font-size:11px; cursor:pointer; flex-shrink:0; transition:all .14s;
}
.nav-back-btn:hover { color:var(--gold); border-color:var(--gold); background:var(--gold-dim) }
.nav-path {
  display:flex; align-items:center; gap:2px;
  flex:1; overflow-x:auto; overflow-y:hidden;
  font-size:11px; white-space:nowrap;
  scrollbar-width:none;
}
.nav-path::-webkit-scrollbar { display:none }
.nav-path .np-item {
  color:var(--text3); cursor:pointer; padding:2px 5px; border-radius:3px;
  transition:all .12s; flex-shrink:0; max-width:120px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}
.nav-path .np-item:hover { color:var(--gold); background:var(--gold-dim) }
.nav-path .np-sep { color:var(--text3); font-size:8px; flex-shrink:0; opacity:.5 }
.nav-path .np-current {
  color:var(--gold); font-weight:600; padding:2px 5px;
  flex-shrink:0; max-width:160px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}

.ned-breadcrumb {
  font-size:11px; color:var(--text3); display:flex; align-items:center; gap:4px;
  flex:1; overflow:hidden; cursor:pointer;
}
.ned-breadcrumb:hover .bc-note { color:var(--gold) }
.ned-breadcrumb .bc-folder { color:var(--text3) }
.ned-breadcrumb .bc-sep { color:var(--text3); font-size:9px }
.ned-breadcrumb .bc-note { color:var(--text2); overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.ned-actions { display:flex; gap:4px; flex-shrink:0; align-items:center; }
/* 노트 내 외부 링크 - 인라인 밑줄 스타일 */
.note-extlink {
  display:inline;
  background:none; border:none; padding:0;
  font-size:inherit;
  color:#4a9eff; text-decoration:underline;
  text-underline-offset:2px; cursor:pointer;
  font-family:inherit;
}
.note-extlink:hover { color:#76b8ff; }
.note-extlink i { font-size:11px; margin-right:2px; opacity:.7; }
/* 유튜브 카드 */
.note-yt-card {
  margin:8px 0; border-radius:6px; overflow:hidden;
  cursor:pointer; display:block; max-width:360px;
  transition: opacity .15s;
}
.note-yt-card:hover { opacity:.85; }
/* 파일 첨부 래퍼 */
.note-file-wrap {
  margin:6px 0; padding:6px 10px;
  background:var(--bg2); border:1px solid var(--border);
  border-radius:6px; display:inline-block;
}
.note-file-label {
  display:block; font-size:11px; color:var(--text3);
  margin-top:4px;
}
/* 파일 아이템 카드 */
.note-file-item {
  display:inline-flex; align-items:center; gap:10px;
  background:var(--bg2); border:1px solid var(--border);
  border-radius:8px; padding:8px 12px; margin:4px 0;
  max-width:320px; cursor:default;
}
.note-file-item:hover { background:var(--bg3); }
.ned-act {
  font-size:11px; padding:3px 10px; border-radius:4px;
  background:var(--bg3); border:1px solid var(--border); color:var(--text2);
  transition:all .12s; white-space:nowrap; cursor:pointer;
}
/* callout placeholder */
.note-callout [data-ph]:empty:before {
  content: attr(data-ph);
  color: var(--text3);
  pointer-events: none;
}
.ned-act.ned-icon {
  padding:4px 7px; font-size:13px; line-height:1;
}
.ned-act:hover { background:var(--gold-dim); border-color:var(--gold); color:var(--gold) }
.ned-save { background:var(--gold); color:var(--bg); border-color:var(--gold); font-weight:700 }
.ned-save:hover { background:var(--gold2); color:var(--bg) }

/* Title input */
.note-title-wrap {
  padding:0; flex-shrink:0;
  display:flex; align-items:stretch; /* 높이 전체 채움 */
  border-bottom:1px solid var(--border);
}
#noteTitle {
  flex:1; background:transparent; border:none; color:var(--text);
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif; font-size:20px; font-weight:700; outline:none;
  padding:10px 16px;
  letter-spacing:-.01em; min-width:0;
}
#noteTitle::placeholder { color:var(--text3) }
/* Folder icon button — flush right, separated by border */
.folder-icon-btn {
  width:44px; flex-shrink:0;
  display:flex; align-items:center; justify-content:center;
  color:var(--text3); transition:all .14s;
  background:transparent; border:none;
  border-left:1px solid var(--border);
  font-size:16px; cursor:pointer;
  border-radius:0;
}
.folder-icon-btn:hover { background:var(--bg3); color:var(--gold) }
.folder-icon-btn.drawer-on { color:var(--gold); background:var(--gold-dim) }

/* Rich text toolbar */
.rte-bar {
  display:flex; flex-direction:column; gap:0;
  background:var(--bg3); border-bottom:1px solid var(--border);
  flex-shrink:0;
}
.rte-row {
  display:flex; gap:1px; align-items:center; flex-wrap:nowrap;
  padding:3px 8px; overflow-x:auto; scrollbar-width:none;
}
.rte-row::-webkit-scrollbar { display:none }
.rte-row2 {
  border-top:1px solid var(--border);
  padding:2px 8px; gap:2px;
}
.rte-row-label {
  font-size:9px; color:var(--text3); font-weight:700;
  letter-spacing:.6px; white-space:nowrap; flex-shrink:0;
}
.rte-insert {
  display:flex; flex-direction:column; align-items:center;
  width:auto !important; height:auto !important;
  padding:2px 5px; gap:1px; border-radius:4px;
}
.rte-lbl {
  font-size:9px; color:var(--text3); line-height:1;
}
.rte-insert:hover .rte-lbl { color:var(--text) }
.rte-btn {
  width:24px; height:24px; border-radius:3px; font-size:11px;
  display:flex; align-items:center; justify-content:center;
  color:var(--text2); transition:all .1s; cursor:pointer; flex-shrink:0;
}
.rte-btn:hover { background:var(--bg4); color:var(--text) }
.rte-btn.rte-on { background:var(--gold-dim); color:var(--gold) }
.rte-sep { width:1px; height:18px; background:var(--border); margin:0 2px; flex-shrink:0 }
.rte-sel {
  background:var(--bg3); border:1px solid var(--border); color:var(--text2);
  border-radius:3px; padding:1px 4px; font-size:11px; outline:none; height:24px; cursor:pointer;
}
.rte-fontsize { width:44px; }


/* Note content editor */
#noteContent {
  flex:1; overflow-y:auto; padding:14px 20px 20px;
  outline:none; font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif; font-size:15px;
  color:var(--text); line-height:2; caret-color:var(--gold2);
  background:var(--bg);
}
#noteContent:empty::before {
  content:attr(data-ph); color:var(--text3); pointer-events:none; font-style:italic;
}
#noteContent h1 { font-size:24px; color:var(--gold2); font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif; font-weight:700; margin:12px 0 4px; border-bottom:1px solid var(--border); padding-bottom:6px }
#noteContent h2 { font-size:19px; color:var(--text); margin:10px 0 3px }
#noteContent h3 { font-size:16px; color:var(--text2); margin:8px 0 2px }
#noteContent ul, #noteContent ol { padding-left:22px; margin:4px 0 }
#noteContent li { margin:2px 0 }
#noteContent blockquote { border-left:3px solid var(--gold); padding-left:14px; margin:8px 0; color:var(--text2); font-style:italic }
#noteContent table { border-collapse:collapse; width:100%; margin:10px 0; font-size:13px }
#noteContent td, #noteContent th { border:1px solid var(--border2); padding:5px 9px }
#noteContent th { background:var(--bg3); color:var(--gold2); font-weight:600 }
#noteContent hr { border:none; border-top:1px solid var(--border); margin:14px 0 }

/* Verse link chip — sync badge 스타일 (초록 pill) */
.vlink {
  display:inline-flex; align-items:center; gap:3px;
  background:rgba(52,211,153,.08); color:#34d399;
  border:1px solid rgba(52,211,153,.25); border-radius:10px;
  padding:1px 8px; font-size:11px; font-family:'JetBrains Mono',monospace;
  cursor:pointer; text-decoration:none; margin:0 2px;
  transition:all .15s;
}
.vlink:hover { background:rgba(52,211,153,.18); border-color:rgba(52,211,153,.4); text-decoration:none }
.vlink i { font-size:9px; opacity:.7 }

/* Note internal link — 블루 pill */
.nlink {
  display:inline-flex; align-items:center; gap:3px;
  background:rgba(96,165,250,.08); color:#60a5fa;
  border:1px solid rgba(96,165,250,.25); border-radius:10px;
  padding:1px 8px; font-size:13px; cursor:pointer;
  transition:all .15s; text-decoration:none;
}
.nlink:hover { background:rgba(96,165,250,.18); border-color:rgba(96,165,250,.4) }
.nlink i { font-size:9px; opacity:.7 }

/* Note footer (tags) */
.note-footer {
  padding:8px 16px; border-top:1px solid var(--border);
  display:flex; align-items:center; gap:6px; flex-wrap:wrap; flex-shrink:0;
  background:var(--bg2);
}
.nfooter-label { font-size:10px; color:var(--text3); flex-shrink:0 }
.tag-row { display:flex; gap:4px; flex-wrap:wrap; align-items:center; flex:1 }
.tag-chip {
  background:rgba(201,151,58,.12); color:var(--gold); border:1px solid rgba(201,151,58,.25);
  border-radius:20px; padding:2px 8px; font-size:11px; display:flex; align-items:center; gap:3px;
}
.tag-x { color:var(--text3); cursor:pointer; font-size:9px; transition:color .1s }
.tag-x:hover { color:var(--red) }
.tag-inp {
  background:transparent; border:1px dashed var(--border2); border-radius:20px;
  padding:2px 8px; font-size:11px; width:65px; outline:none; color:var(--text);
}
.tag-inp:focus { border-color:var(--gold) }
.folder-sel-lbl { font-size:10px; color:var(--text3) }
#noteFolderSel {
  background:var(--bg3); border:1px solid var(--border); color:var(--text2);
  border-radius:4px; padding:2px 6px; font-size:11px; outline:none; cursor:pointer;
}

/* Backlink panel */
.backlink-panel {
  border-top:1px solid var(--border); 
  border-bottom:1px solid var(--border);
  flex-shrink:0;
  background:var(--bg2); 
  max-height:200px; 
  overflow-y:auto;
  margin-top:8px;
  margin-bottom:8px;
}
.backlink-head {
  padding:8px 12px; 
  font-size:11px; 
  font-weight:700; 
  color:var(--gold2);
  text-transform:uppercase; 
  letter-spacing:.8px; 
  display:flex; 
  align-items:center; 
  gap:5px;
  cursor:pointer; 
  user-select:none;
  background:var(--bg3);
}
.backlink-head:hover { background:var(--bg4); }
.bl-entry {
  display:flex; 
  align-items:center; 
  gap:6px; 
  padding:6px 12px; 
  border-radius:4px;
  cursor:pointer; 
  transition:background .1s; 
  font-size:12px; 
  color:var(--text2);
  margin:2px 6px;
}
.bl-entry:hover { background:var(--bg4); color:var(--gold) }
.bl-entry i { font-size:10px; color:var(--gold); opacity:0.6; }
.bl-entry-folder { 
  font-size:10px; 
  color:var(--text3); 
  margin-left:auto;
  background:var(--bg4);
  padding:2px 6px;
  border-radius:3px;
}
#backlinkList {
  padding:4px 0;
}

