/* typing.css — 성경 타자 연습 · Glassmorphism */

/* ═══ Overlay ═══ */
.tp-overlay {
  /* Fixed typing game colors — independent of theme */
  --bg: #08090f;
  --bg2: #101218;
  --bg3: #1a1d28;
  --bg4: #1a1d28;
  --border: #252838;
  --border2: #252838;
  --text: #e6e8f0;
  --text2: #a0a5b8;
  --text3: #5a6080;
  --text-primary: #e6e8f0;
  --gold: #d4a017;
  --gold-dim: rgba(212,160,23,0.12);
  --gold-sel: rgba(212,160,23,0.20);
  --accent-color: #60a5fa;
  --accent-dim: rgba(96,165,250,0.12);
  --red: #ff4757;
  --shadow-color: rgba(0,0,0,0.50);
  --radius: 8px;

  /* Glass tokens */
  --glass-bg: rgba(255,255,255,0.04);
  --glass-border: rgba(255,255,255,0.08);
  --glass-highlight: rgba(255,255,255,0.06);

  visibility:hidden; opacity:0;
  position:fixed; inset:0; z-index:800;
  background: linear-gradient(135deg, #0a0a1a 0%, #0d1025 30%, #151030 60%, #0a0a1a 100%);
  display:flex; flex-direction:column;
  transition:opacity .25s, visibility .25s;
}
.tp-overlay.tp-show { visibility:visible; opacity:1; }

/* ═══ Header — glass ═══ */
.tp-header {
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 32px;
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom:1px solid var(--glass-border);
  box-shadow: 0 1px 0 rgba(255,255,255,0.04), 0 4px 20px rgba(0,0,0,0.15);
  flex-shrink:0;
}
.tp-title {
  font-size:17px; font-weight:700; color:var(--text);
  display:flex; align-items:center; gap:10px;
}
.tp-title i { color:var(--gold); font-size:18px; }
.tp-header-right { display:flex; align-items:center; gap:14px; }
.tp-lang-group {
  display:flex;
  background: rgba(255,255,255,0.04);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border:1px solid var(--glass-border);
  border-radius:8px; overflow:hidden;
}
.tp-lang {
  padding:6px 16px; font-size:13px; font-weight:600;
  background:transparent; color:var(--text3); cursor:pointer;
  border:none; transition:all .15s;
}
.tp-lang:first-child { border-right:1px solid var(--glass-border); }
.tp-lang.active { background:var(--gold); color:var(--bg); }
.tp-close {
  width:36px; height:36px; border-radius:8px; display:flex;
  align-items:center; justify-content:center;
  font-size:16px; color:var(--text3); cursor:pointer;
  transition:all .15s;
}
.tp-close:hover { background:rgba(255,255,255,0.06); color:var(--text); }

/* ═══ Settings Bar — glass ═══ */
.tp-settings {
  padding:12px 32px;
  background: rgba(255,255,255,0.03);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom:1px solid var(--glass-border);
  flex-shrink:0;
}
.tp-source-row {
  display:flex; gap:8px; flex-wrap:wrap; margin-bottom:8px;
}
.tp-src-btn {
  padding:7px 14px; border-radius:8px; font-size:12px; font-weight:600;
  background: rgba(255,255,255,0.03);
  color:var(--text3);
  border:1px solid rgba(255,255,255,0.06);
  cursor:pointer; transition:all .15s; display:flex; align-items:center; gap:6px;
}
.tp-src-btn:hover { border-color:rgba(255,255,255,0.15); color:var(--text); }
.tp-src-btn.active {
  background:var(--gold-dim); border-color:var(--gold); color:var(--gold);
}
.tp-sel-row {
  display:flex; gap:10px; align-items:center; flex-wrap:wrap;
  margin-top:8px;
}
.tp-select {
  padding:7px 12px; border-radius:8px; font-size:13px;
  background: rgba(255,255,255,0.04);
  border:1px solid var(--glass-border);
  color:var(--text); outline:none; cursor:pointer; max-width:200px;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}
.tp-select:focus { border-color:var(--gold); }
.tp-small-btn {
  padding:6px 12px; border-radius:6px; font-size:12px; font-weight:600;
  background: rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.06);
  color:var(--text3);
  cursor:pointer; transition:all .12s; display:flex; align-items:center; gap:5px;
}
.tp-small-btn:hover { border-color:var(--gold); color:var(--gold); }
.tp-small-btn.tp-del:hover { border-color:var(--red,#e74c3c); color:var(--red,#e74c3c); }

/* 폴더 태그 리스트 */
.tp-folder-list {
  display:flex; flex-wrap:wrap; gap:6px; margin-top:10px;
}
.tp-folder-tag {
  display:inline-flex; align-items:center; gap:5px;
  padding:4px 10px; border-radius:6px; font-size:11px;
  background: rgba(255,255,255,0.04);
  color:var(--text2);
  border:1px solid var(--glass-border);
}
.tp-folder-tag i {
  font-size:9px; cursor:pointer; opacity:.5; transition:opacity .1s;
}
.tp-folder-tag i:hover { opacity:1; color:var(--red,#e74c3c); }

/* ═══ Body (typing area) ═══ */
.tp-body {
  flex:1; overflow-y:auto; display:flex;
  flex-direction:column; align-items:center;
  justify-content:center; padding:40px 40px;
}

/* Start Screen */
.tp-start-screen {
  text-align:center; display:flex; flex-direction:column;
  align-items:center; gap:24px;
}
.tp-start-icon {
  font-size:64px; color:var(--text3); opacity:.25;
}
.tp-start-msg {
  font-size:16px; color:var(--text3);
}
.tp-start-btn {
  padding:14px 40px; border-radius:12px; font-size:16px; font-weight:700;
  background:var(--gold); color:var(--bg); border:none; cursor:pointer;
  transition:all .15s; display:flex; align-items:center; gap:10px;
  box-shadow: 0 0 20px rgba(212,160,23,0.35), 0 4px 12px rgba(0,0,0,0.2);
}
.tp-start-btn:hover {
  filter:brightness(1.1); transform:translateY(-1px);
  box-shadow: 0 0 28px rgba(212,160,23,0.45), 0 6px 16px rgba(0,0,0,0.25);
}

/* Verse Area */
.tp-verse-area {
  width:100%; max-width:960px; margin-bottom:28px;
  position:relative;
}
.tp-verse-header {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:16px;
}
.tp-verse-ref {
  display:flex; align-items:baseline; gap:10px;
}
.tp-ref-book {
  font-size:26px; font-weight:800; color:var(--gold);
  font-family:'Playfair Display','Noto Sans KR',serif;
  letter-spacing:-.3px;
}
.tp-ref-chv {
  font-size:20px; font-weight:700; color:var(--accent-color,#60a5fa);
  font-family:'JetBrains Mono',monospace;
}
.tp-verse-acts {
  display:flex; align-items:center; gap:4px;
}
.tp-heart-btn {
  width:40px; height:40px; border-radius:50%; display:flex;
  align-items:center; justify-content:center;
  font-size:20px; color:var(--text3); cursor:pointer;
  transition:all .15s; background:transparent; border:none;
}
.tp-heart-btn:hover { color:#ff6b81; }
.tp-heart-btn.tp-hearted { color:#ff4757; }
.tp-heart-btn.tp-hearted:hover { color:#ff6b81; }
@keyframes tp-heartPop {
  0%,100% { transform:scale(1); }
  50% { transform:scale(1.3); }
}

/* Character display — glass card */
.tp-chars {
  font-size:24px; line-height:2.2; color:var(--text);
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
  padding:32px 40px; border-radius:16px;
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow: 0 4px 24px rgba(0,0,0,0.20),
              inset 0 1px 0 rgba(255,255,255,0.06);
  word-break:break-all; user-select:none;
  cursor:text; min-height:120px;
  position:relative;
  transition: border-color .15s;
}
.tp-chars:hover { border-color:rgba(255,255,255,0.18); }

/* 미입력 글자 */
.tp-char {
  border-radius:2px; color:#fff; opacity:0.5;
  transition:opacity .1s, color .1s;
  display:inline-block;
}
/* 정확하게 친 글자: 골드 색상으로 강조 */
.tp-char.tp-correct {
  color:#d4a017; opacity:1; font-weight:600;
}
/* 오타: 빨간 잉크 */
.tp-char.tp-wrong {
  color:#ff4757; opacity:1;
  background:rgba(255,71,87,.12);
  text-decoration:line-through;
  text-decoration-color:rgba(255,71,87,.5);
}
/* 타격 펀치 — 정확 */
@keyframes tp-punch {
  0%   { transform:scale(1.45); text-shadow:0 0 8px rgba(212,160,23,.6); }
  100% { transform:scale(1);    text-shadow:none; }
}
.tp-char.tp-punch { animation:tp-punch .18s ease-out; }
/* 타격 펀치 — 오타 */
@keyframes tp-punch-err {
  0%   { transform:scale(1.3); text-shadow:0 0 8px rgba(255,71,87,.6); }
  50%  { transform:translateX(-2px); }
  100% { transform:translateX(0) scale(1); text-shadow:none; }
}
.tp-char.tp-punch-err { animation:tp-punch-err .2s ease-out; }
/* 커서 위치 */
.tp-char.tp-cursor {
  opacity:0.7; color:#fff;
  border-bottom:2.5px solid #d4a017;
  animation:tp-blink 1s step-end infinite;
}
/* 한글 조합 중 (실시간 자모 표시) */
.tp-char.tp-composing {
  color:#60a5fa; opacity:1;
  border-bottom:2.5px solid #60a5fa;
  background:rgba(96,165,250,.08);
  transition:none;
}
@keyframes tp-blink {
  0%,100% { border-bottom-color:#d4a017; }
  50% { border-bottom-color:transparent; }
}

/* 숨겨진 입력 textarea (IME 캡처용) */
.tp-ghost-input {
  position:absolute; left:0; bottom:0;
  width:100%; height:1px; min-height:0;
  padding:0; margin:0; border:none;
  opacity:0; overflow:hidden; resize:none;
  font-size:24px;
  pointer-events:none;
}

/* Stats bar */
.tp-stats {
  display:flex; gap:28px; justify-content:center;
  margin-top:20px; flex-wrap:wrap; width:100%; max-width:960px;
}
.tp-stats span {
  font-size:14px; color:var(--text3); font-weight:500;
  display:flex; align-items:center; gap:6px;
}
.tp-stats i { color:var(--gold); font-size:13px; }

/* ═══ Result Screen ═══ */
.tp-result {
  width:100%; max-width:960px;
  display:flex; flex-direction:column; align-items:center; gap:28px;
  animation:tp-fadeUp .45s ease;
}
@keyframes tp-fadeUp {
  from { opacity:0; transform:translateY(24px); }
  to { opacity:1; transform:translateY(0); }
}
.tp-result-head {
  text-align:center; display:flex; flex-direction:column;
  align-items:center; gap:6px;
}
.tp-result-icon { font-size:52px; color:var(--gold); }
.tp-result-title {
  font-size:28px; font-weight:800; color:var(--text);
}
.tp-result-ref {
  font-size:15px; color:var(--text3);
  font-family:'JetBrains Mono',monospace;
}

/* Stat cards — glass */
.tp-result-cards {
  display:flex; gap:20px; justify-content:center;
  flex-wrap:wrap; width:100%;
}
.tp-rcard {
  flex:1; min-width:160px; max-width:230px;
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border:1px solid rgba(255,255,255,0.10);
  border-radius:16px; padding:24px 20px;
  display:flex; flex-direction:column; align-items:center;
  gap:8px; text-align:center; position:relative;
  box-shadow: 0 4px 24px rgba(0,0,0,0.18),
              inset 0 1px 0 rgba(255,255,255,0.06);
  transition: background .2s, border-color .2s;
}
.tp-rcard:hover {
  background: rgba(255,255,255,0.09);
  border-color: rgba(255,255,255,0.15);
}

/* SVG accuracy ring */
.tp-ring-wrap {
  position:relative; width:120px; height:120px;
}
.tp-ring-svg {
  width:120px; height:120px; transform:rotate(-90deg);
}
.tp-ring-bg {
  fill:none; stroke:var(--bg3); stroke-width:8;
}
.tp-ring-fill {
  fill:none; stroke:var(--gold); stroke-width:8;
  stroke-linecap:round;
  animation:tp-ringDraw 1s ease forwards;
}
@keyframes tp-ringDraw {
  from { stroke-dashoffset:326.7; }
}
.tp-ring-text {
  position:absolute; inset:0;
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  pointer-events:none;
}
.tp-ring-num {
  font-size:30px; font-weight:800; color:var(--text);
  font-family:'JetBrains Mono',monospace;
}
.tp-ring-num small { font-size:16px; font-weight:600; }
.tp-ring-lbl {
  font-size:12px; color:var(--gold); font-weight:700;
  margin-top:2px;
}
.tp-rcard-title {
  font-size:13px; color:var(--text3); font-weight:600;
}
.tp-rcard-big {
  font-size:40px; font-weight:800; color:var(--text);
  font-family:'JetBrains Mono',monospace; line-height:1.1;
}
.tp-rcard-unit {
  font-size:13px; color:var(--text3); font-weight:500;
}
.tp-rcard-wpm {
  font-size:15px; font-weight:700;
  color:var(--accent-color,#60a5fa);
  margin-top:6px;
}

/* Speed bar */
.tp-rcard-bar-wrap {
  width:100%; height:6px;
  background: rgba(255,255,255,0.06);
  border-radius:3px; overflow:hidden; margin-top:8px;
}
.tp-rcard-bar {
  height:100%; border-radius:3px; background:var(--gold);
  animation:tp-barGrow .8s ease; transform-origin:left;
}
@keyframes tp-barGrow {
  from { transform:scaleX(0); }
  to { transform:scaleX(1); }
}
.tp-rcard-tag { font-size:12px; font-weight:700; margin-top:2px; }
.tp-spd-fast { color:var(--gold); }
.tp-spd-good { color:#4ade80; }
.tp-spd-normal { color:var(--text2); }
.tp-spd-slow { color:var(--text3); }

/* Character breakdown chart — glass */
.tp-result-chart {
  width:100%; max-width:540px;
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px; padding:20px 28px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15),
              inset 0 1px 0 rgba(255,255,255,0.04);
}
.tp-chart-title {
  font-size:14px; font-weight:700; color:var(--text);
  margin-bottom:12px; display:flex; align-items:center; gap:8px;
}
.tp-chart-title i { color:var(--gold); font-size:13px; }
.tp-chart-bar {
  display:flex; width:100%; height:16px;
  border-radius:8px; overflow:hidden;
  background: rgba(255,255,255,0.04);
}
.tp-cbar-ok {
  background:var(--gold);
  animation:tp-barGrow .8s ease; transform-origin:left;
}
.tp-cbar-err {
  background:#ff4757;
  animation:tp-barGrow .8s ease .12s both; transform-origin:left;
}
.tp-cbar-skip {
  background:var(--text3); opacity:.4;
  animation:tp-barGrow .8s ease .2s both; transform-origin:left;
}
.tp-chart-legend {
  display:flex; gap:18px; flex-wrap:wrap; margin-top:12px;
}
.tp-chart-legend span {
  font-size:13px; color:var(--text2); display:flex; align-items:center; gap:6px;
}
.tp-dot {
  width:10px; height:10px; border-radius:50%; display:inline-block; flex-shrink:0;
}

/* Result actions */
.tp-result-acts {
  display:flex; gap:12px; align-items:center;
  flex-wrap:wrap; justify-content:center;
}
.tp-next-btn {
  padding:14px 32px; border-radius:12px; font-size:16px; font-weight:700;
  background:var(--gold); color:var(--bg); border:none; cursor:pointer;
  transition:all .15s; display:flex; align-items:center; gap:8px;
  box-shadow: 0 0 20px rgba(212,160,23,0.35), 0 4px 12px rgba(0,0,0,0.2);
}
.tp-next-btn:hover {
  filter:brightness(1.1); transform:translateY(-1px);
  box-shadow: 0 0 28px rgba(212,160,23,0.45), 0 6px 16px rgba(0,0,0,0.25);
}

/* Folder button & dropdown menu */
.tp-folder-wrap {
  position:relative;
}
.tp-folder-btn {
  width:40px; height:40px; border-radius:50%; display:flex;
  align-items:center; justify-content:center;
  font-size:18px; color:var(--text3); cursor:pointer;
  background:transparent; border:none; transition:all .15s;
}
.tp-folder-btn:hover { color:var(--gold); background:rgba(255,255,255,0.06); }

.tp-folder-menu {
  display:none; position:absolute; top:calc(100% + 8px); right:0;
  min-width:220px; max-height:320px; overflow-y:auto;
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:14px; padding:6px 0;
  box-shadow: 0 8px 32px rgba(0,0,0,.35),
              inset 0 1px 0 rgba(255,255,255,0.06);
  z-index:100;
  animation:tp-menuPop .18s ease;
}
.tp-folder-menu.tp-fm-open { display:block; }
@keyframes tp-menuPop {
  from { opacity:0; transform:translateY(-6px); }
  to   { opacity:1; transform:translateY(0); }
}
.tp-fm-label {
  padding:8px 16px 4px; font-size:11px; font-weight:700;
  color:var(--text3); text-transform:uppercase; letter-spacing:.5px;
}
.tp-fm-item {
  display:flex; align-items:center; gap:10px;
  padding:9px 16px; font-size:13px; color:var(--text2);
  cursor:pointer; transition:background .1s;
}
.tp-fm-item:hover { background:rgba(255,255,255,0.06); color:var(--text); }
.tp-fm-item i { font-size:14px; width:18px; text-align:center; color:var(--text3); }
.tp-fm-item.tp-fm-added i { color:var(--gold); }
.tp-fm-item.tp-fm-added span { color:var(--text); }
.tp-fm-badge {
  margin-left:auto; font-size:10px; font-weight:600;
  color:var(--gold); background:var(--gold-dim);
  padding:2px 7px; border-radius:4px;
}
.tp-fm-divider {
  height:1px; background:rgba(255,255,255,0.08); margin:4px 12px;
}
.tp-fm-create { color:var(--gold); font-weight:600; }
.tp-fm-create i { color:var(--gold) !important; }
.tp-fm-create:hover { background:rgba(212,160,23,0.10); }

.tp-result-enter {
  font-size:12px; color:var(--text3); opacity:.5;
  display:flex; align-items:center; gap:6px;
}

/* ═══ Real-time Speed Gauge ═══ */
.tp-speed-wrap {
  width:100%; max-width:960px;
  display:flex; flex-direction:column; align-items:center;
  gap:8px; margin-bottom:28px;
}
.tp-speed-num {
  font-size:48px; font-weight:900; color:#3a4060;
  font-family:'JetBrains Mono',monospace;
  text-align:center; line-height:1;
  transition:color 0.25s, text-shadow 0.35s, transform 0.12s ease-out;
  transform:scale(1); transform-origin:center bottom;
  will-change:transform;
  margin-bottom:2px;
}
.tp-speed-gauge {
  width:100%; height:5px;
  background: rgba(255,255,255,0.06);
  border-radius:3px; overflow:hidden;
}
.tp-speed-bar {
  height:100%; border-radius:3px; width:0%;
  background:linear-gradient(90deg, #4a8fe8, #d4a017);
  transition:width 0.12s ease-out;
}

/* ═══ Previous vs Current CPM Delta ═══ */
.tp-rcard-delta {
  font-size:13px; font-weight:700; margin-top:6px;
  display:flex; align-items:center; gap:5px;
}
.tp-delta-up { color:#4ade80; }
.tp-delta-down { color:#ff4757; }
.tp-delta-same { color:#a0a5b8; }
.tp-delta-prev { font-size:11px; font-weight:500; opacity:0.55; }

/* ═══ Theme Toggle Button ═══ */
.tp-theme-btn {
  width:36px; height:36px; border-radius:8px; display:flex;
  align-items:center; justify-content:center;
  font-size:16px; color:var(--text3); cursor:pointer;
  background:transparent; border:none; transition:all .15s;
}
.tp-theme-btn:hover { background:rgba(255,255,255,0.06); color:var(--gold); }

/* ═══ Best CPM in speed card ═══ */
.tp-rcard-best {
  font-size:12px; font-weight:600; color:var(--gold);
  display:flex; align-items:center; gap:5px;
  margin-top:4px; opacity:0.75;
}
.tp-rcard-best i { font-size:11px; }

/* ═══ Session Summary Bar — glass ═══ */
.tp-session-bar {
  width:100%; max-width:640px;
  display:flex; gap:20px; justify-content:center; flex-wrap:wrap;
  padding:12px 20px; border-radius:12px;
  background: rgba(255,255,255,0.04);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border:1px solid var(--glass-border);
  box-shadow: 0 2px 16px rgba(0,0,0,0.12);
}
.tp-session-bar span {
  font-size:13px; font-weight:600; color:var(--text2);
  display:flex; align-items:center; gap:6px;
}
.tp-session-bar i { color:var(--gold); font-size:12px; }

/* ═══ Light Theme (Red Accent) — Glassmorphism ═══ */
.tp-overlay.tp-light {
  --bg: #fdf5f5;
  --bg2: #ffffff;
  --bg3: #fce8e8;
  --bg4: #f8d8d8;
  --border: #e8b8b8;
  --border2: #ecc8c8;
  --text: #2a1418;
  --text2: #6a3a42;
  --text3: #9a6870;
  --text-primary: #2a1418;
  --gold: #d63040;
  --gold-dim: rgba(214,48,64,0.10);
  --gold-sel: rgba(214,48,64,0.16);
  --accent-color: #e8384a;
  --accent-dim: rgba(232,56,74,0.10);
  --red: #b81c2c;
  --shadow-color: rgba(120,20,30,0.08);
  --glass-bg: rgba(255,255,255,0.50);
  --glass-border: rgba(180,80,90,0.15);
  --glass-highlight: rgba(255,255,255,0.60);

  background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 30%, #fce0e0 60%, #fff0f0 100%);
}
.tp-overlay.tp-light .tp-char {
  color:#4a2830; opacity:0.38;
}
.tp-overlay.tp-light .tp-char.tp-correct {
  color:#d63040; opacity:1; font-weight:700;
}
.tp-overlay.tp-light .tp-char.tp-wrong {
  color:#8b1a1a; opacity:1;
  background:rgba(139,26,26,.12);
  text-decoration-color:rgba(139,26,26,.5);
}
.tp-overlay.tp-light .tp-char.tp-cursor {
  color:#2a1418; opacity:0.8;
  border-bottom:2.5px solid #e8384a;
}
.tp-overlay.tp-light .tp-char.tp-composing {
  color:#e8384a;
  border-bottom-color:#e8384a;
  background:rgba(232,56,74,.08);
}
.tp-overlay.tp-light .tp-speed-gauge {
  background:rgba(214,48,64,0.08);
}
.tp-overlay.tp-light .tp-header {
  background: rgba(255,255,255,0.55);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom:1px solid rgba(180,80,90,0.12);
  box-shadow: 0 1px 0 rgba(255,255,255,0.5), 0 4px 20px rgba(140,30,40,0.06);
}
.tp-overlay.tp-light .tp-settings {
  background: rgba(255,255,255,0.40);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom:1px solid rgba(180,80,90,0.10);
}
.tp-overlay.tp-light .tp-chars {
  background: rgba(255,255,255,0.55);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border:1px solid rgba(180,80,90,0.15);
  box-shadow: 0 4px 24px rgba(140,30,40,0.08),
              inset 0 1px 0 rgba(255,255,255,0.6);
}
.tp-overlay.tp-light .tp-chars:hover {
  border-color:rgba(180,80,90,0.25);
}
.tp-overlay.tp-light .tp-start-btn {
  box-shadow: 0 0 20px rgba(214,48,64,0.30), 0 4px 12px rgba(140,30,40,0.15);
}
.tp-overlay.tp-light .tp-start-btn:hover {
  box-shadow: 0 0 28px rgba(214,48,64,0.40), 0 6px 16px rgba(140,30,40,0.20);
}
.tp-overlay.tp-light .tp-src-btn {
  background: rgba(255,255,255,0.40);
  border:1px solid rgba(180,80,90,0.10);
}
.tp-overlay.tp-light .tp-src-btn:hover {
  border-color:rgba(180,80,90,0.25);
}
.tp-overlay.tp-light .tp-src-btn.active {
  background:rgba(214,48,64,0.10);
  border-color:#d63040;
  color:#b82030;
}
.tp-overlay.tp-light .tp-rcard {
  background: rgba(255,255,255,0.55);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border:1px solid rgba(180,80,90,0.12);
  box-shadow: 0 4px 24px rgba(140,30,40,0.08),
              inset 0 1px 0 rgba(255,255,255,0.6);
}
.tp-overlay.tp-light .tp-rcard:hover {
  background: rgba(255,255,255,0.65);
  border-color: rgba(180,80,90,0.20);
}
.tp-overlay.tp-light .tp-result-chart {
  background: rgba(255,255,255,0.50);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border:1px solid rgba(180,80,90,0.12);
  box-shadow: 0 4px 20px rgba(140,30,40,0.06),
              inset 0 1px 0 rgba(255,255,255,0.5);
}
.tp-overlay.tp-light .tp-session-bar {
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border:1px solid rgba(180,80,90,0.10);
  box-shadow: 0 2px 16px rgba(140,30,40,0.05);
}
.tp-overlay.tp-light .tp-next-btn {
  box-shadow: 0 0 20px rgba(214,48,64,0.30), 0 4px 12px rgba(140,30,40,0.15);
}
.tp-overlay.tp-light .tp-next-btn:hover {
  box-shadow: 0 0 28px rgba(214,48,64,0.40), 0 6px 16px rgba(140,30,40,0.20);
}
.tp-overlay.tp-light .tp-lang-group {
  background: rgba(255,255,255,0.45);
  border:1px solid rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-lang:first-child {
  border-right:1px solid rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-lang.active {
  background:#d63040; color:#fff;
}
.tp-overlay.tp-light .tp-select {
  background: rgba(255,255,255,0.45);
  border:1px solid rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-select:focus {
  border-color:#d63040;
}
.tp-overlay.tp-light .tp-small-btn {
  background: rgba(255,255,255,0.40);
  border:1px solid rgba(180,80,90,0.10);
}
.tp-overlay.tp-light .tp-small-btn:hover {
  border-color:#d63040; color:#d63040;
}
.tp-overlay.tp-light .tp-ring-fill {
  stroke:#d63040;
}
.tp-overlay.tp-light .tp-ring-lbl {
  color:#d63040;
}
.tp-overlay.tp-light .tp-folder-menu {
  background: rgba(255,255,255,0.70);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border:1px solid rgba(180,80,90,0.15);
  box-shadow: 0 8px 32px rgba(140,30,40,0.12),
              inset 0 1px 0 rgba(255,255,255,0.6);
}
.tp-overlay.tp-light .tp-fm-item:hover {
  background:rgba(214,48,64,0.06);
}
.tp-overlay.tp-light .tp-fm-divider {
  background:rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-fm-create:hover {
  background:rgba(214,48,64,0.08);
}
.tp-overlay.tp-light .tp-folder-btn:hover {
  color:#d63040; background:rgba(214,48,64,0.06);
}
.tp-overlay.tp-light .tp-close:hover {
  background:rgba(214,48,64,0.06); color:#2a1418;
}
.tp-overlay.tp-light .tp-theme-btn:hover {
  background:rgba(214,48,64,0.06); color:#d63040;
}
.tp-overlay.tp-light .tp-folder-tag {
  background: rgba(255,255,255,0.45);
  border:1px solid rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-rcard-bar-wrap {
  background:rgba(214,48,64,0.06);
}
.tp-overlay.tp-light .tp-chart-bar {
  background:rgba(214,48,64,0.06);
}
@keyframes tp-blink-light {
  0%,100% { border-bottom-color:#e8384a; }
  50% { border-bottom-color:transparent; }
}
.tp-overlay.tp-light .tp-char.tp-cursor {
  animation:tp-blink-light 1s step-end infinite;
}

/* ═══ Score Card ═══ */
.tp-score-glow { color:var(--gold) !important; }
.tp-score-formula {
  font-size:11px; color:var(--text3); margin-top:6px;
  font-family:'JetBrains Mono',monospace;
  opacity:0.7;
}
.tp-rank-score {
  font-weight:800; color:var(--gold);
  font-family:'JetBrains Mono',monospace; font-size:16px;
}

/* ═══ Nickname Input ═══ */
.tp-nickname-row {
  display:flex; align-items:center; gap:10px;
  margin-bottom:8px;
}
.tp-nickname-row i {
  font-size:18px; color:var(--text3);
}
.tp-nickname-input {
  padding:10px 16px; border-radius:10px; font-size:15px; font-weight:600;
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border:1px solid var(--glass-border);
  color:var(--text); outline:none;
  width:220px; text-align:center;
  transition:border-color .15s, box-shadow .15s;
}
.tp-nickname-input::placeholder { color:var(--text3); font-weight:400; }
.tp-nickname-input:focus {
  border-color:var(--gold);
  box-shadow: 0 0 12px rgba(212,160,23,0.20);
}

/* ═══ Ranking Header Button (in tp-header) ═══ */
.tp-rank-btn {
  width:36px; height:36px; border-radius:8px; display:flex;
  align-items:center; justify-content:center;
  font-size:16px; color:var(--text3); cursor:pointer;
  background:transparent; border:none; transition:all .15s;
}
.tp-rank-btn:hover { background:rgba(255,255,255,0.06); color:var(--gold); }

/* ═══ Ranking View ═══ */
.tp-ranking-wrap {
  width:100%; max-width:960px;
  display:flex; flex-direction:column; gap:20px;
  animation:tp-fadeUp .35s ease;
}
.tp-ranking-header {
  display:flex; align-items:center; gap:16px;
}
.tp-rank-back {
  padding:8px 16px; border-radius:8px; font-size:13px; font-weight:600;
  background: rgba(255,255,255,0.04);
  border:1px solid var(--glass-border);
  color:var(--text2); cursor:pointer;
  transition:all .15s; display:flex; align-items:center; gap:6px;
}
.tp-rank-back:hover { border-color:var(--gold); color:var(--gold); }
.tp-ranking-title {
  font-size:22px; font-weight:800; color:var(--text);
  display:flex; align-items:center; gap:10px;
}
.tp-ranking-title i { color:var(--gold); }

/* Ranking filter tabs */
.tp-rank-filters {
  display:flex; gap:6px;
}
.tp-rank-filter {
  padding:7px 18px; border-radius:8px; font-size:13px; font-weight:600;
  background: rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.06);
  color:var(--text3); cursor:pointer;
  transition:all .15s;
}
.tp-rank-filter:hover { border-color:rgba(255,255,255,0.15); color:var(--text); }
.tp-rank-filter.active {
  background:var(--gold-dim); border-color:var(--gold); color:var(--gold);
}

/* Ranking table wrapper — glass */
.tp-rank-table-wrap {
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border:1px solid rgba(255,255,255,0.10);
  border-radius:16px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.18),
              inset 0 1px 0 rgba(255,255,255,0.06);
  overflow:hidden;
  max-height:calc(100vh - 280px);
  overflow-y:auto;
}
.tp-rank-loading {
  padding:48px; text-align:center; font-size:15px;
  color:var(--text3); display:flex; align-items:center;
  justify-content:center; gap:10px;
}
.tp-rank-loading i { color:var(--gold); }
.tp-rank-empty {
  padding:60px 20px; text-align:center; color:var(--text3);
  display:flex; flex-direction:column; align-items:center; gap:12px;
}
.tp-rank-empty i { font-size:40px; opacity:0.3; }
.tp-rank-empty p { font-size:15px; }

/* Table */
.tp-rank-table {
  width:100%; border-collapse:collapse; font-size:14px;
}
.tp-rank-table thead {
  position:sticky; top:0; z-index:2;
}
.tp-rank-table th {
  padding:12px 14px; font-size:12px; font-weight:700;
  color:var(--text3); text-transform:uppercase; letter-spacing:.5px;
  text-align:left; border-bottom:1px solid rgba(255,255,255,0.08);
  background: rgba(255,255,255,0.04);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}
.tp-rank-table td {
  padding:11px 14px; border-bottom:1px solid rgba(255,255,255,0.04);
  color:var(--text2); transition:background .1s;
}
.tp-rank-table tbody tr:hover td {
  background:rgba(255,255,255,0.03);
}

/* Medal styling */
.tp-medal { font-size:20px; }
.tp-rank-num {
  display:inline-flex; align-items:center; justify-content:center;
  width:28px; height:28px; border-radius:50%;
  font-size:12px; font-weight:700; color:var(--text3);
  background:rgba(255,255,255,0.04);
}
.tp-rank-pos { text-align:center; width:50px; }
.tp-rank-nick { font-weight:600; color:var(--text); }
.tp-rank-cpm {
  font-weight:800; color:var(--gold);
  font-family:'JetBrains Mono',monospace; font-size:16px;
}
.tp-rank-acc { font-weight:600; }
.tp-rank-verse { font-size:12px; color:var(--text3); }
.tp-rank-date { font-size:12px; color:var(--text3); }

/* My rank highlight */
.tp-rank-me td {
  background:rgba(212,160,23,0.08) !important;
}
.tp-rank-me .tp-rank-nick { color:var(--gold); }
.tp-rank-me-badge {
  display:inline-block; font-size:10px; font-weight:700;
  padding:2px 6px; border-radius:4px;
  background:var(--gold); color:var(--bg);
  margin-left:6px; vertical-align:middle;
}

/* Top 3 special styling */
.tp-rank-top3 td { background:rgba(255,255,255,0.02); }
.tp-rank-top3 .tp-rank-cpm { font-size:18px; }

/* ═══ Ranking — Light Theme ═══ */
.tp-overlay.tp-light .tp-nickname-input {
  background: rgba(255,255,255,0.50);
  border:1px solid rgba(180,80,90,0.15);
}
.tp-overlay.tp-light .tp-nickname-input:focus {
  border-color:#d63040;
  box-shadow: 0 0 12px rgba(214,48,64,0.15);
}
.tp-overlay.tp-light .tp-rank-btn:hover {
  background:rgba(214,48,64,0.06); color:#d63040;
}
.tp-overlay.tp-light .tp-rank-back {
  background: rgba(255,255,255,0.40);
  border:1px solid rgba(180,80,90,0.12);
}
.tp-overlay.tp-light .tp-rank-back:hover {
  border-color:#d63040; color:#d63040;
}
.tp-overlay.tp-light .tp-rank-filter {
  background: rgba(255,255,255,0.40);
  border:1px solid rgba(180,80,90,0.10);
}
.tp-overlay.tp-light .tp-rank-filter:hover {
  border-color:rgba(180,80,90,0.25);
}
.tp-overlay.tp-light .tp-rank-filter.active {
  background:rgba(214,48,64,0.10);
  border-color:#d63040; color:#b82030;
}
.tp-overlay.tp-light .tp-rank-table-wrap {
  background: rgba(255,255,255,0.55);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border:1px solid rgba(180,80,90,0.12);
  box-shadow: 0 4px 24px rgba(140,30,40,0.08),
              inset 0 1px 0 rgba(255,255,255,0.6);
}
.tp-overlay.tp-light .tp-rank-table th {
  background: rgba(255,255,255,0.50);
  border-bottom:1px solid rgba(180,80,90,0.10);
}
.tp-overlay.tp-light .tp-rank-table td {
  border-bottom:1px solid rgba(180,80,90,0.06);
}
.tp-overlay.tp-light .tp-rank-table tbody tr:hover td {
  background:rgba(214,48,64,0.03);
}
.tp-overlay.tp-light .tp-rank-me td {
  background:rgba(214,48,64,0.08) !important;
}
.tp-overlay.tp-light .tp-rank-me .tp-rank-nick { color:#d63040; }
.tp-overlay.tp-light .tp-rank-me-badge {
  background:#d63040; color:#fff;
}
.tp-overlay.tp-light .tp-rank-num {
  background:rgba(214,48,64,0.06);
}

/* ═══ backdrop-filter fallback ═══ */
@supports not (backdrop-filter: blur(1px)) {
  .tp-header { background: rgba(16,18,24,0.95); }
  .tp-settings { background: rgba(16,18,24,0.92); }
  .tp-chars { background: rgba(16,18,24,0.94); }
  .tp-rcard { background: rgba(16,18,24,0.92); }
  .tp-result-chart { background: rgba(16,18,24,0.92); }
  .tp-session-bar { background: rgba(16,18,24,0.90); }
  .tp-folder-menu { background: rgba(16,18,24,0.95); }
  .tp-overlay.tp-light .tp-header { background: rgba(255,255,255,0.92); }
  .tp-overlay.tp-light .tp-settings { background: rgba(255,255,255,0.90); }
  .tp-overlay.tp-light .tp-chars { background: rgba(255,255,255,0.94); }
  .tp-overlay.tp-light .tp-rcard { background: rgba(255,255,255,0.92); }
  .tp-overlay.tp-light .tp-result-chart { background: rgba(255,255,255,0.92); }
  .tp-overlay.tp-light .tp-session-bar { background: rgba(255,255,255,0.90); }
  .tp-overlay.tp-light .tp-folder-menu { background: rgba(255,255,255,0.95); }
}

/* ═══ Responsive ═══ */
@media(max-width:600px){
  .tp-header { padding:10px 14px; }
  .tp-settings { padding:10px 14px; }
  .tp-body { padding:20px 14px; }
  .tp-chars { font-size:18px; padding:18px 16px; min-height:80px; border-radius:12px; }
  .tp-source-row { gap:5px; }
  .tp-src-btn { padding:5px 10px; font-size:11px; }
  .tp-ref-book { font-size:20px; }
  .tp-ref-chv { font-size:16px; }
  .tp-stats span { font-size:12px; }
  .tp-result-cards { gap:10px; }
  .tp-rcard { min-width:120px; padding:16px 12px; border-radius:12px; }
  .tp-ring-wrap { width:96px; height:96px; }
  .tp-ring-svg { width:96px; height:96px; }
  .tp-ring-num { font-size:24px; }
  .tp-rcard-big { font-size:30px; }
  .tp-result-title { font-size:22px; }
  .tp-result-icon { font-size:40px; }
  .tp-result-chart { padding:14px 16px; border-radius:12px; }
  .tp-chart-legend { gap:10px; }
  .tp-chart-legend span { font-size:11px; }
  .tp-speed-num { font-size:36px; }
  .tp-rcard-delta { font-size:11px; }
  .tp-session-bar { gap:12px; padding:10px 14px; border-radius:10px; }
  .tp-session-bar span { font-size:11px; }
  .tp-rcard-best { font-size:11px; }
  /* Ranking responsive */
  .tp-ranking-title { font-size:18px; }
  .tp-rank-filter { padding:6px 12px; font-size:12px; }
  .tp-rank-table { font-size:12px; }
  .tp-rank-table th { padding:8px 8px; font-size:10px; }
  .tp-rank-table td { padding:8px 8px; }
  .tp-rank-cpm { font-size:14px !important; }
  .tp-rank-hide-mobile { display:none; }
  .tp-rank-table-wrap { max-height:calc(100vh - 240px); }
  .tp-nickname-input { width:180px; font-size:14px; padding:8px 12px; }
  .tp-medal { font-size:16px; }
}
