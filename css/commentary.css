/* ═══════════════════════════════════════════════
   COMMENTARY — Redesigned Study Notes
═══════════════════════════════════════════════ */
.comm-body-wrap { flex:1; overflow-y:auto; padding:0 }

/* ── Empty state ── */
.comm-empty {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:48px 20px; gap:10px; text-align:center;
}
.comm-empty-icon { font-size:28px; color:var(--text3); opacity:.4 }
.comm-empty-msg { font-size:13px; color:var(--text3); line-height:1.9 }

/* ══════════════════════════════════════════════
   VERSE MODE
══════════════════════════════════════════════ */
.cv-wrap { padding:0 }

/* ── Hero Header ── */
.cv-hero {
  padding:16px 18px 12px;
  background:var(--glass-bg-1);
  backdrop-filter:var(--glass-blur-1); -webkit-backdrop-filter:var(--glass-blur-1);
  border-bottom:1px solid var(--glass-border);
  box-shadow:var(--glass-highlight);
  position:sticky; top:0; z-index:2;
}
.cv-hero-ref {
  font-size:14px; font-weight:800;
  color:var(--accent-color);
  font-family:'JetBrains Mono','Noto Sans KR',monospace;
  letter-spacing:.3px; margin-bottom:6px;
}
.cv-hero-kr {
  font-size:13px; color:var(--text);
  font-family:'KoPubWorld Batang','Noto Serif KR',serif;
  line-height:1.7; margin-bottom:3px;
}
.cv-hero-en {
  font-size:11.5px; color:var(--text3);
  font-style:italic; line-height:1.5; margin-bottom:8px;
}

/* Stats badges */
.cv-stats { display:flex; flex-wrap:wrap; gap:6px; }
.cv-badge {
  display:inline-flex; align-items:center; gap:3px;
  font-size:10px; color:var(--text3);
  background:var(--glass-bg-1); border:1px solid var(--glass-border);
  border-radius:10px; padding:2px 8px;
  transition:all .15s;
}
.cv-badge i { font-size:8px; }
.cv-badge-hl i { color:var(--accent-color); font-size:6px; }
.cv-badge-link { cursor:pointer; }
.cv-badge-link:hover { color:var(--accent-color); border-color:var(--accent-color); }

/* ── Sections ── */
.cv-sections { padding:4px 0 16px; }

.cv-sec {
  border-bottom:1px solid var(--glass-border);
}
.cv-sec:last-child { border-bottom:none; }

/* Section head (clickable toggle) */
.cv-sec-head {
  display:flex; align-items:center; gap:8px;
  padding:10px 18px;
  cursor:pointer; user-select:none;
  transition:background .1s;
}
.cv-sec-head:hover { background:var(--glass-bg-1); }
.cv-sec-icon { font-size:11px; width:16px; text-align:center; }
.cv-sec-label {
  flex:1; font-size:11px; font-weight:700;
  color:var(--text2); letter-spacing:.3px;
  text-transform:uppercase;
}
.cv-sec-chev {
  font-size:9px; color:var(--text3);
  transition:transform .2s;
  transform:rotate(-90deg);
}

/* Open state */
.cv-sec-open .cv-sec-chev { transform:rotate(0deg); }
.cv-sec-body {
  display:none;
  padding:0 18px 14px;
}
.cv-sec-open .cv-sec-body { display:block; }

/* ── Type-specific section colors ── */

/* 참고 주석 */
.cv-sec-commentary .cv-sec-icon { color:var(--accent-color); }
.cv-comm-body {
  font-size:13px; color:var(--text2); line-height:1.85;
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
}

/* 연결된 구절 */
.cv-sec-refs .cv-sec-icon { color:#6495ed; }
.cv-refs { display:flex; flex-direction:column; gap:0; }
.cv-ref-row {
  display:flex; align-items:baseline; gap:10px;
  padding:7px 0; cursor:pointer;
  border-bottom:1px solid var(--border);
  transition:color .1s;
}
.cv-ref-row:last-child { border-bottom:none; }
.cv-ref-row:hover { color:var(--accent-color); }
.cv-ref-row:hover .cv-ref-label { color:var(--accent-color); }
.cv-ref-label {
  font-size:11px; color:#6495ed;
  font-family:'JetBrains Mono',monospace;
  min-width:80px; flex-shrink:0; font-weight:600;
}
.cv-ref-txt {
  font-size:12px; color:var(--text3); line-height:1.5;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap; flex:1;
}
.cv-ref-chips { display:flex; flex-wrap:wrap; gap:4px; margin-top:6px; }

/* 구절 주석 메모 */
.cv-sec-vmemo .cv-sec-icon { color:#a084c8; }
.cv-vmemo {
  font-size:13px; color:var(--text); line-height:1.8;
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
  padding:8px 12px;
  background:rgba(160,132,200,.06);
  border-radius:6px; border-left:3px solid #a084c8;
}

/* 하이라이트 메모 */
.cv-sec-hl .cv-sec-icon { color:var(--accent-color); }
.cv-hl-item {
  margin-bottom:12px; padding-bottom:12px;
  border-bottom:1px solid var(--border);
}
.cv-hl-item:last-child { margin-bottom:0; padding-bottom:0; border-bottom:none; }
.cv-hl-quote {
  display:flex; align-items:flex-start; gap:8px;
  padding:6px 12px;
  font-size:12.5px; color:var(--text2);
  font-family:'KoPubWorld Batang','Noto Serif KR',serif;
  line-height:1.7;
  border-left:3px solid var(--accent-color);
  background:transparent;
}
.cv-hl-dot {
  width:7px; height:7px; border-radius:50%;
  flex-shrink:0; margin-top:5px;
}
.cv-hl-memo {
  padding:6px 12px 4px; font-size:13px;
  color:var(--text); line-height:1.8;
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
}
.cv-hl-tags { padding:2px 12px 0; display:flex; flex-wrap:wrap; gap:4px; }
.cv-memo-tag {
  font-size:9px; color:var(--accent-color); background:var(--accent-dim);
  border-radius:4px; padding:2px 6px;
}

/* 연결된 노트 */
.cv-sec-notes .cv-sec-icon { color:#50c8b0; }
.cv-note-row {
  display:flex; align-items:center; gap:10px;
  padding:8px 10px; border-radius:6px;
  cursor:pointer; transition:all .12s;
  margin-bottom:2px;
}
.cv-note-row:hover { background:rgba(80,200,176,.1); }
.cv-note-icon { color:#50c8b0; font-size:12px; flex-shrink:0; width:20px; text-align:center; }
.cv-note-info { flex:1; min-width:0; }
.cv-note-title {
  font-size:13px; color:var(--text);
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}
.cv-note-folder { font-size:9px; color:var(--text3); margin-top:1px; display:flex; align-items:center; gap:3px; }
.cv-note-folder i { font-size:8px; }

/* ── 교차 참조 칩 (공용) ── */
.cross-refs, .cv-ref-chips { display:flex; gap:5px; flex-wrap:wrap }
.cref {
  font-size:10px; font-family:'JetBrains Mono',monospace;
  background:rgba(100,149,237,.1); color:rgba(130,180,255,.9); border-radius:6px;
  padding:3px 8px; cursor:pointer; border:1px solid rgba(100,149,237,.15);
  transition:all .13s;
}
.cref:hover { background:rgba(100,149,237,.22); border-color:rgba(100,149,237,.3); }

/* ══════════════════════════════════════════════
   CHAPTER MODE
══════════════════════════════════════════════ */
.cc-wrap { padding:0; }
.cc-title {
  display:flex; align-items:center; gap:8px;
  padding:14px 18px; font-size:13px; font-weight:700;
  color:var(--accent-color);
  font-family:'JetBrains Mono','Noto Sans KR',monospace;
  border-bottom:1px solid var(--glass-border);
  background:var(--glass-bg-1);
  backdrop-filter:var(--glass-blur-1); -webkit-backdrop-filter:var(--glass-blur-1);
  box-shadow:var(--glass-highlight);
  position:sticky; top:0; z-index:2;
}
.cc-title i { font-size:12px; }

/* Verse block */
.cc-verse {
  border-bottom:1px solid var(--border);
  transition:background .1s;
}
.cc-verse:last-child { border-bottom:none; }

.cc-vhead {
  display:flex; align-items:baseline; gap:8px;
  padding:12px 18px 8px;
  cursor:pointer; transition:background .08s;
}
.cc-vhead:hover { background:var(--glass-bg-1); }
.cc-vnum {
  font-family:'JetBrains Mono',monospace;
  font-size:13px; font-weight:800;
  color:var(--accent-color); min-width:24px; flex-shrink:0;
}
.cc-vtxt {
  font-size:12px; color:var(--text3);
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
  line-height:1.5; flex:1; min-width:0;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}
.cc-badges {
  display:flex; gap:4px; flex-shrink:0; align-items:center;
}
.cc-badge {
  display:inline-flex; align-items:center; gap:2px;
  font-size:9px; color:var(--text3);
}
.cc-badge i { font-size:8px; color:var(--text3); opacity:.6; }

/* Selected verse */
.cc-verse-sel {
  background:var(--accent-dim);
}
.cc-verse-sel .cc-vnum { color:var(--accent-color); }

/* Verse body (content items) */
.cc-vbody { padding:0 18px 12px 50px; }

.cc-item { margin-bottom:8px; }
.cc-item:last-child { margin-bottom:0; }

.cc-item-comm {
  font-size:12.5px; color:var(--text2); line-height:1.75;
  font-family:'KoPubWorld Dotum','Noto Sans KR',sans-serif;
}

.cc-item-refs { margin-top:4px; }

.cc-item-notes { display:flex; flex-wrap:wrap; gap:4px; margin-top:4px; }
.cc-note-chip {
  display:inline-flex; align-items:center; gap:4px;
  font-size:10px; color:#50c8b0; cursor:pointer;
  padding:3px 8px; background:rgba(80,200,176,.08);
  border:1px solid rgba(80,200,176,.15); border-radius:5px;
  transition:all .1s;
}
.cc-note-chip:hover { background:rgba(80,200,176,.18); }
.cc-note-chip i { font-size:9px; }

.cc-item-hl { margin-top:6px; }
.cc-hl-quote {
  font-size:11px; color:var(--text3);
  font-family:'KoPubWorld Batang','Noto Serif KR',serif;
  line-height:1.6; padding:4px 10px;
  border-left:3px solid var(--accent-color);
}
.cc-hl-memo {
  font-size:11.5px; color:var(--text2); line-height:1.6;
  padding:2px 10px 0;
}

/* ── 장별/구절별 모드 바 ── */
.comm-mode-bar {
  display:flex; gap:0; border-bottom:1px solid var(--glass-border);
  background:var(--glass-bg-1);
  backdrop-filter:var(--glass-blur-1); -webkit-backdrop-filter:var(--glass-blur-1);
  flex-shrink:0;
}
.comm-mode-btn {
  flex:1; padding:8px 0;
  border:none; border-bottom:2px solid transparent;
  background:transparent; color:var(--text3);
  font-size:11px; cursor:pointer;
  display:flex; align-items:center; justify-content:center; gap:5px;
  transition:all .15s;
}
.comm-mode-btn:hover { color:var(--text2); background:var(--glass-bg-2); }
.comm-mode-btn.comm-mode-active {
  color:var(--accent-color);
  border-bottom-color:var(--accent-color);
  font-weight:700;
}

/* ── Light mode corrections — 웜 로즈 잉크 톤 ── */
[data-theme="light"] .cv-vmemo { background:rgba(180,40,60,.05); border-left-color:hsl(350,50%,45%); }
[data-theme="light"] .cv-ref-label { color:hsl(350, 50%, 40%); }
[data-theme="light"] .cref { background:rgba(180,40,60,.07); color:hsl(350,50%,38%); border-color:rgba(180,40,60,.14); }
[data-theme="light"] .cref:hover { background:rgba(180,40,60,.14); }
[data-theme="light"] .cv-note-icon { color:hsl(350,45%,40%); }
[data-theme="light"] .cv-note-row:hover { background:rgba(180,40,60,.05); }
[data-theme="light"] .cc-note-chip { color:hsl(350,45%,40%); background:rgba(180,40,60,.05); border-color:rgba(180,40,60,.12); }
[data-theme="light"] .cc-note-chip:hover { background:rgba(180,40,60,.12); }
[data-theme="light"] .cv-sec-head:hover { background:var(--glass-bg-2); }
[data-theme="light"] .comm-mode-btn:hover { color:var(--text-primary); background:var(--glass-bg-2); }
[data-theme="light"] .comm-mode-btn.comm-mode-active { color:var(--accent-color); border-bottom-color:var(--accent-color); }
[data-theme="light"] .cc-vhead:hover { background:var(--glass-bg-2); }
[data-theme="light"] .cc-verse-sel { background:hsla(var(--accent-h),60%,50%,.10); }
[data-theme="light"] .cv-comm-body { color:hsl(350, 28%, 18%); }

/* ── Sepia mode corrections — 따뜻한 양피지 톤 ── */
[data-theme="sepia"] .cv-vmemo { background:rgba(107,69,149,.06); border-left-color:hsl(270,35%,42%); }
[data-theme="sepia"] .cv-ref-label { color:hsl(210, 30%, 42%); }
[data-theme="sepia"] .cref { background:rgba(58,109,158,.08); color:hsl(210,30%,40%); border-color:rgba(58,109,158,.15); }
[data-theme="sepia"] .cref:hover { background:rgba(58,109,158,.16); }
[data-theme="sepia"] .cv-note-icon { color:hsl(155,40%,32%); }
[data-theme="sepia"] .cv-note-row:hover { background:rgba(42,110,72,.06); }
[data-theme="sepia"] .cc-note-chip { color:hsl(155,40%,32%); background:rgba(42,110,72,.05); border-color:rgba(42,110,72,.12); }
[data-theme="sepia"] .cc-note-chip:hover { background:rgba(42,110,72,.12); }
[data-theme="sepia"] .cv-sec-head:hover { background:var(--glass-bg-2); }
[data-theme="sepia"] .cv-comm-body { color:hsl(22, 26%, 20%); }
