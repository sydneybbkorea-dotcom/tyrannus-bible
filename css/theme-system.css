/* ═══════════════════════════════════════════════
   THEME SYSTEM — 3 Themes + 8 Accent Colors
   HSL-based dynamic color system (Obsidian Light & Bright inspired)
═══════════════════════════════════════════════ */

/* ── Default Accent (다크: #bd8a00, 라이트: #f06f38) ── */
:root {
  --accent-h: 44;
  --accent-s: 100%;
  --accent-l: 37%;
}

/* ── Default Book Accent (성경 본문 강조: 장 제목, 구절 번호) ── */
:root {
  --book-h: 50;
  --book-s: 100%;
  --book-l: 50%;
}
/* ── Accent Color Palettes ── */
:root[data-accent="blue"] {
  --accent-h: 214;
  --accent-s: 92%;
  --accent-l: 45%;
}
:root[data-accent="red"] {
  --accent-h: 0;
  --accent-s: 96%;
  --accent-l: 43%;
}
:root[data-accent="orange"] {
  --accent-h: 30;
  --accent-s: 90%;
  --accent-l: 46%;
}
:root[data-accent="yellow"] {
  --accent-h: 46;
  --accent-s: 100%;
  --accent-l: 44%;
}
:root[data-accent="cyan"] {
  --accent-h: 179;
  --accent-s: 100%;
  --accent-l: 37%;
}
:root[data-accent="purple"] {
  --accent-h: 256;
  --accent-s: 83%;
  --accent-l: 63%;
}
:root[data-accent="pink"] {
  --accent-h: 330;
  --accent-s: 65%;
  --accent-l: 53%;
}
:root[data-accent="black"] {
  --accent-h: 0;
  --accent-s: 0%;
  --accent-l: 65%;
}

/* ── Book Accent Color Palettes (성경 본문 강조색) ── */
:root[data-book-accent="blue"]   { --book-h:214; --book-s:92%;  --book-l:45%; }
:root[data-book-accent="red"]    { --book-h:0;   --book-s:96%;  --book-l:43%; }
:root[data-book-accent="orange"] { --book-h:30;  --book-s:90%;  --book-l:46%; }
:root[data-book-accent="yellow"] { --book-h:46;  --book-s:100%; --book-l:44%; }
:root[data-book-accent="cyan"]   { --book-h:179; --book-s:100%; --book-l:37%; }
:root[data-book-accent="purple"] { --book-h:256; --book-s:83%;  --book-l:63%; }
:root[data-book-accent="pink"]   { --book-h:330; --book-s:65%;  --book-l:53%; }
:root[data-book-accent="black"]  { --book-h:0;   --book-s:0%;   --book-l:65%; }

/* ── Default Base (첫 방문 기본값: #04050b) ── */
:root { --base-h: 231; --base-s: 47%; --base-l: 3%; }
/* ── Base Color Palettes (배경 H/S/L) ── */
:root[data-base="blue"]           { --base-h: 214; --base-s: 35%; --base-l: 5%; }
:root[data-base="red"]            { --base-h: 355; --base-s: 35%; --base-l: 5%; }
:root[data-base="orange"]         { --base-h: 30;  --base-s: 35%; --base-l: 5%; }
:root[data-base="yellow"]         { --base-h: 46;  --base-s: 35%; --base-l: 5%; }
:root[data-base="cyan"]           { --base-h: 179; --base-s: 35%; --base-l: 5%; }
:root[data-base="purple"]         { --base-h: 256; --base-s: 35%; --base-l: 5%; }
:root[data-base="pink"]           { --base-h: 330; --base-s: 35%; --base-l: 5%; }
:root[data-base="black"]          { --base-h: 0;   --base-s: 0%;  --base-l: 3%; }

/* ── Computed Accent (shared across all themes) ── */
:root {
  --accent-color: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
  --accent-hover: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) + 8%));
  --accent-dim: hsla(var(--accent-h), var(--accent-s), var(--accent-l), 0.12);
  --accent-sel: hsla(var(--accent-h), 60%, 50%, 0.20);
}

/* ── Computed Book Accent (성경 본문 강조색) ── */
:root {
  --book-color: hsl(var(--book-h), var(--book-s), var(--book-l));
  --book-hover: hsl(var(--book-h), var(--book-s), calc(var(--book-l) + 8%));
  --book-dim:   hsla(var(--book-h), var(--book-s), var(--book-l), 0.12);
}

/* ── Theme 1: Light — warm rose-white (red accent feel) ── */
:root[data-theme="light"] {
  --bg-primary:     hsl(0, 52%, 96%);       /* 선명한 로즈 화이트 */
  --bg-secondary:   hsl(0, 45%, 92%);       /* 패널 — 뚜렷한 핑크 구분 */
  --bg-tertiary:    hsl(0, 35%, 86%);       /* 입력/버튼 — 로즈 깊이 */
  --bg-surface:     hsl(0, 40%, 98%);       /* 따뜻한 화이트 종이 */
  --text-primary:   hsl(350, 36%, 12%);     /* 깊은 다크 와인 — 최대 가독성 */
  --text-secondary: hsl(350, 22%, 34%);     /* 워밍 보조 텍스트 */
  --text-muted:     hsl(350, 14%, 52%);     /* 로즈 그레이 */
  --text-faint:     hsl(350, 8%, 66%);      /* 희미한 로즈 */
  --border-color:   hsl(0, 38%, 82%);       /* 뚜렷한 로즈 경계선 */
  --shadow-color:   rgba(120, 20, 30, 0.10);/* 강한 로즈 그림자 */
  --hl-opacity:     0.32;
  --rail-bg-color:  hsl(0, 42%, 93%);       /* 레일 배경 — 선명한 웜 로즈 */
  --content-text:       #720808;            /* 딥 버건디 잉크 본문 */
  --content-text-sub:   hsl(350, 14%, 34%); /* 보조 본문 */
  /* 강조색 강제 오버라이드: 선명한 레드 */
  --accent-color:   #d70404;
  --accent-hover:   #e81818;
  --accent-dim:     rgba(215, 4, 4, 0.12);
  --accent-sel:     rgba(215, 4, 4, 0.20);
}

/* ── Theme 2: Dark (default) — base S/L relative offsets ── */
:root, :root[data-theme="dark"] {
  --bg-primary:     hsl(var(--base-h), var(--base-s), var(--base-l));
  --bg-secondary:   hsl(var(--base-h), calc(var(--base-s) - 7%), calc(var(--base-l) + 4%));
  --bg-tertiary:    hsl(var(--base-h), calc(var(--base-s) - 13%), calc(var(--base-l) + 10%));
  --bg-surface:     hsl(var(--base-h), calc(var(--base-s) - 7%), calc(var(--base-l) + 5%));
  --text-primary:   hsl(var(--base-h), 10%, 92%);
  --text-secondary: hsl(var(--base-h), 8%, 70%);
  --text-muted:     hsl(var(--base-h), 6%, 48%);
  --text-faint:     hsl(var(--base-h), 5%, 35%);
  --border-color:   hsl(var(--base-h), calc(var(--base-s) - 13%), calc(var(--base-l) + 8%));
  --shadow-color:   rgba(0, 0, 0, 0.50);
  --hl-opacity:     0.45;
  --rail-bg-color:  hsl(var(--base-h), var(--base-s), calc(var(--base-l) - 1%));
  --content-text:       hsl(0, 0%, 93%);
  --content-text-sub:   hsl(0, 0%, 73%);
}

/* ── Theme 3: Sepia — aged parchment (warm amber-brown) ── */
:root[data-theme="sepia"] {
  --bg-primary:     hsl(36, 33%, 93%);      /* 따뜻한 양피지 */
  --bg-secondary:   hsl(34, 26%, 87%);      /* 에이지드 패널 */
  --bg-tertiary:    hsl(32, 20%, 80%);      /* 깊은 따뜻함 (입력/버튼) */
  --bg-surface:     hsl(40, 40%, 96%);      /* 크림빛 종이 */
  --text-primary:   hsl(22, 36%, 15%);      /* 깊은 에스프레소 브라운 */
  --text-secondary: hsl(22, 18%, 34%);      /* 월넛 브라운 */
  --text-muted:     hsl(25, 12%, 50%);      /* 부드러운 카키 */
  --text-faint:     hsl(28, 8%, 64%);       /* 희미한 베이지 */
  --border-color:   hsl(32, 18%, 78%);      /* 오크빛 경계선 */
  --shadow-color:   rgba(80, 50, 15, 0.07); /* 따뜻한 앰버 그림자 */
  --hl-opacity:     0.28;
  --rail-bg-color:  hsl(34, 24%, 85%);      /* 레일 배경 */
  --content-text:       hsl(22, 30%, 15%);  /* 초콜릿 잉크 본문 */
  --content-text-sub:   hsl(22, 14%, 36%);  /* 보조 본문 */
}

/* ── Dark + Black accent: monochrome accent colors ── */
:root[data-theme="dark"][data-accent="black"],
:root[data-accent="black"]:not([data-theme="light"]):not([data-theme="sepia"]) {
  --accent-color:   hsl(0, 0%, 80%);
  --accent-hover:   hsl(0, 0%, 90%);
  --accent-dim:     hsla(0, 0%, 80%, 0.10);
  --accent-sel:     hsla(0, 0%, 80%, 0.15);
}

/* ── Light + Black accent: warm ink for readability ── */
:root[data-theme="light"][data-accent="black"] {
  --accent-color:   hsl(350, 18%, 18%);
  --accent-hover:   hsl(350, 14%, 28%);
  --accent-dim:     hsla(350, 18%, 10%, 0.08);
  --accent-sel:     hsla(350, 18%, 10%, 0.12);
}

/* ── Sepia + Black accent: espresso brown for readability ── */
:root[data-theme="sepia"][data-accent="black"] {
  --accent-color:   hsl(22, 20%, 18%);
  --accent-hover:   hsl(22, 16%, 28%);
  --accent-dim:     hsla(22, 20%, 10%, 0.08);
  --accent-sel:     hsla(22, 20%, 10%, 0.12);
}

/* ── Dark + Black book accent: monochrome book colors ── */
:root[data-theme="dark"][data-book-accent="black"],
:root[data-book-accent="black"]:not([data-theme="light"]):not([data-theme="sepia"]) {
  --book-color: hsl(0, 0%, 80%);
  --book-hover: hsl(0, 0%, 90%);
  --book-dim:   hsla(0, 0%, 80%, 0.10);
}

/* ── Light + Black book accent: warm ink ── */
:root[data-theme="light"][data-book-accent="black"] {
  --book-color: hsl(350, 18%, 18%);
  --book-hover: hsl(350, 14%, 28%);
  --book-dim:   hsla(350, 18%, 10%, 0.08);
}

/* ── Sepia + Black book accent: espresso brown ── */
:root[data-theme="sepia"][data-book-accent="black"] {
  --book-color: hsl(22, 20%, 18%);
  --book-hover: hsl(22, 16%, 28%);
  --book-dim:   hsla(22, 20%, 10%, 0.08);
}

/* ── Glass Morphism Tokens (3-layer system) ── */
:root, :root[data-theme="dark"] {
  --glass-bg-1: rgba(255,255,255,0.03);
  --glass-bg-2: rgba(255,255,255,0.05);
  --glass-bg-3: rgba(255,255,255,0.07);
  --glass-border: rgba(255,255,255,0.08);
  --glass-highlight: inset 0 1px 0 rgba(255,255,255,0.05);
  --glass-shadow: 0 8px 32px rgba(0,0,0,0.3);
  --glass-blur-1: blur(12px);
  --glass-blur-2: blur(20px);
  --glass-blur-3: blur(24px);
  --body-gradient: linear-gradient(135deg, #0a0a1a, #0d1025, #151030, #0a0a1a);
}

:root[data-theme="light"] {
  --glass-bg-1: rgba(255,255,255,0.45);
  --glass-bg-2: rgba(255,255,255,0.55);
  --glass-bg-3: rgba(255,255,255,0.65);
  --glass-border: rgba(180,80,90,0.12);
  --glass-highlight: inset 0 1px 0 rgba(255,255,255,0.5);
  --glass-shadow: 0 8px 32px rgba(140,30,40,0.06);
  --glass-blur-1: blur(12px);
  --glass-blur-2: blur(20px);
  --glass-blur-3: blur(24px);
  --body-gradient: linear-gradient(135deg, #fff5f5, #ffe8e8, #fce0e0, #fff0f0);
}

:root[data-theme="sepia"] {
  --glass-bg-1: rgba(255,245,230,0.35);
  --glass-bg-2: rgba(255,245,230,0.50);
  --glass-bg-3: rgba(255,245,230,0.60);
  --glass-border: rgba(120,80,30,0.12);
  --glass-highlight: inset 0 1px 0 rgba(255,250,240,0.4);
  --glass-shadow: 0 8px 32px rgba(80,50,15,0.08);
  --glass-blur-1: blur(12px);
  --glass-blur-2: blur(20px);
  --glass-blur-3: blur(24px);
  --body-gradient: linear-gradient(135deg, #f5ead6, #f0e0c4, #ebe0c0, #f5ead6);
}

/* ── Design System Tokens ── */
:root {
  /* Spacing (4px base unit) */
  --sp-1: 4px;
  --sp-2: 8px;
  --sp-3: 12px;
  --sp-4: 16px;
  --sp-6: 24px;
  --sp-8: 32px;
  --sp-12: 48px;

  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;

  /* Shadows */
  --shadow-sm: 0 1px 3px var(--shadow-color);
  --shadow-md: 0 4px 12px var(--shadow-color);
  --shadow-lg: 0 8px 32px var(--shadow-color);

  /* Animation */
  --anim-fast: 150ms ease-out;
  --anim-normal: 250ms ease;
  --anim-slow: 350ms ease;

  /* Typography Scale */
  --font-h1: 24px;
  --font-h2: 20px;
  --font-h3: 17px;
  --font-body: 15px;
  --font-caption: 13px;
  --font-small: 11px;

  /* Touch targets */
  --touch-min: 44px;
  --mouse-min: 32px;

  /* Highlight Colors */
  --hl-yellow: hsla(48, 100%, 50%, var(--hl-opacity));
  --hl-green:  hsla(120, 60%, 50%, var(--hl-opacity));
  --hl-blue:   hsla(210, 80%, 55%, var(--hl-opacity));
  --hl-pink:   hsla(330, 80%, 55%, var(--hl-opacity));
  --hl-purple: hsla(270, 70%, 55%, var(--hl-opacity));
  --hl-orange: hsla(30, 90%, 50%, var(--hl-opacity));

  /* Focus ring (accessibility) */
  --focus-ring: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--accent-color);
}

/* ── Focus Ring for Accessibility ── */
:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
}

/* ── WCAG AA contrast helpers ── */
[data-theme="light"] .accent-text { color: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) - 8%)); }
[data-theme="dark"]  .accent-text { color: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) + 10%)); }
[data-theme="sepia"] .accent-text { color: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) - 5%)); }

/* ── @supports fallback: backdrop-filter 미지원 시 불투명 배경 ── */
@supports not (backdrop-filter: blur(1px)) {
  :root, :root[data-theme="dark"] {
    --glass-bg-1: var(--bg-secondary);
    --glass-bg-2: var(--bg-tertiary);
    --glass-bg-3: var(--bg-tertiary);
  }
  :root[data-theme="light"] {
    --glass-bg-1: hsla(0, 45%, 92%, 0.95);
    --glass-bg-2: hsla(0, 40%, 90%, 0.95);
    --glass-bg-3: hsla(0, 35%, 88%, 0.95);
  }
  :root[data-theme="sepia"] {
    --glass-bg-1: hsla(34, 26%, 87%, 0.95);
    --glass-bg-2: hsla(32, 20%, 83%, 0.95);
    --glass-bg-3: hsla(32, 18%, 80%, 0.95);
  }
}

/* ── Mobile: reduce blur for performance ── */
@media (max-width: 600px) {
  :root {
    --glass-blur-1: blur(8px);
    --glass-blur-2: blur(12px);
    --glass-blur-3: blur(16px);
  }
}
